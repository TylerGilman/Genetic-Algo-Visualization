<!DOCTYPE html>
<html>
<head>
    <title>Fish Evolution Simulation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/js/genetic-fish-simulation.js"></script>
    <script src="/static/js/fish.js"></script>
    <script src="/static/js/simulation-stats.js"></script>
    <script src="/static/js/ui-controller.js"></script>
</head>
<body>

    {% include 'simulation_content.html' %}
    {% include 'intro.html' %}
    
    <script>
        function initializeUI() {
            console.log("Attempting to initialize UI...");
            try {
                console.log("Creating UIController instance");
                const uiController = new UIController();
                console.log("UI initialization complete");
                return uiController;
            } catch (error) {
                console.error("Error during UI initialization:", error);
                throw error;
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            let initAttempts = 0;
            const maxAttempts = 5;

            function attemptInitialization() {
                console.log(`Initialization attempt ${initAttempts + 1} of ${maxAttempts}`);
                try {
                    initializeUI();
                    console.log("Successfully initialized UI");
                } catch (error) {
                    console.error("Failed to initialize UI:", error);
                    initAttempts++;
                    if (initAttempts < maxAttempts) {
                        setTimeout(attemptInitialization, 1000);
                    }
                }
            }

            attemptInitialization();
        });
    </script>
</body>
</html>
